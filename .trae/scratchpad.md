# BananaPod 项目状态记录

## 背景和动机
用户要求将 BananaPod 的 UI 彻底重构为 **Aura Theme**（海军蓝/青色系），参考 `PodUI copy.html`。核心目标是建立统一、现代、具有品牌感（"Made in Aura"）的设计系统，并确保所有组件遵循此标准。

## 关键挑战和分析
1.  **一致性**：确保所有组件（Toolbar, Sidebar, Panels）使用相同的玻璃拟态和颜色变量。
2.  **去硬编码**：识别并替换散落在各个组件中的 hex 颜色代码。
3.  **交互反馈**：Hover、Active、Focus 状态需要统一的青色光晕效果。

## 高层任务拆分 (Aura UI 重构)

### 阶段一：基础建设 (已完成)
1.  **字体集成**：引入 Montserrat 和 Montserrat Alternates。
2.  **设计系统 (PodUI)**：建立 `podui.css`，定义 `--bg-page`, `--brand-primary` 等核心变量及 `pod-glass` 等工具类。
3.  **基础控件**：标准化 Input, Slider, Checkbox 样式。

### 阶段二：核心组件 (进行中)
19. **App 容器**：设置深色背景 (`#020617`) 及 "Made in Aura" 水印。
20. **PromptBar**：实现悬浮胶囊玻璃形态。
    - [ ] 参考 `PodUI copy.html` Input 样式
    - [ ] 整合 Generate Button 到输入框内部
    - [ ] 优化输入框 Focus/Hover 态
21. **Toolbar**：实现悬浮工具栏及选中态发光效果。

### 阶段三：画布交互与细节 (进行中)
26. **右键菜单**：自定义 Context Menu 的深色样式。
27. **选择控件**：选框 (Selection Box)、套索 (Lasso) 的青色描边与填充。
28. **裁剪工具**：裁剪框及遮罩的样式适配。
29. **文本编辑**：画布内文本输入框样式。
30. **代码清理**：移除残留的硬编码颜色 (Toolbar, Sidebar)。

## 项目状态看板 (15项任务监控)

| ID | 任务名称 | 状态 | 说明 |
| :--- | :--- | :--- | :--- |
| 01 | **全局字体 (Montserrat)** | ✅ 完成 | `index.html` 已引入 |
| 02 | **Aura CSS 变量系统** | ✅ 完成 | `podui.css` 已定义核心变量 |
| 03 | **通用 UI 组件库** | ✅ 完成 | `pod-input`, `pod-slider` 等已实现 |
| 04 | **App 背景与水印** | ✅ 完成 | 这里的背景色和 Branding 已更新 |
| 05 | **PromptBar 重构** | ✅ 完成 | 已优化为圆角矩形，布局规整 |
| 06 | **Toolbar 样式重构** | ✅ 完成 | Navy Glass 风格 (Agewell Agent Card) |
| 07 | **BananaSidebar 重构** | ✅ 完成 | 样式已统一为 Aura 圆角风格 |
| 08 | **LayerPanel 重构** | ✅ 完成 | 拖拽高亮已修复 |
| 09 | **BoardPanel 重构** | ✅ 完成 | 边框颜色已修复 |
| 10 | **CanvasSettings 重构** | ✅ 完成 | 输入框样式已统一 |
| 11 | **Context Menu 样式** | ✅ 完成 | 变量替换已完成 |
| 12 | **选择/套索工具样式** | ✅ 完成 | 已替换为 `--brand-primary` |
| 13 | **裁剪工具样式** | ✅ 完成 | 已适配 Aura 配色 |
| 14 | **文本编辑框样式** | ✅ 完成 | 已增加 `--text-heading` 回退 |
| 15 | **残留硬编码清理** | ✅ 完成 | 关键组件已清理完毕 |

- [x] 09. 版本发布 qd0.1.0 <!-- id: 9 -->
  - [x] 提交所有更改
  - [x] 合并到主支 (main)
  - [x] 打标签 qd0.1.0
  - [x] 清理 Git 历史中的大文件 (release/)
  - [x] 推送到远程仓库 (HTTPS 成功)

### 当前状态/进度跟踪
- **版本发布**：已成功清理 `release/` 目录的大文件（将仓库大小缩减至 ~7MB），并成功推送到 `https://github.com/zzpzz009/Banana_QDAI.git`。所有标签（包括 `qd0.1.0`）均已同步。
- **Toolbar 样式**：已完成样式标准化与修正，等待用户确认最终效果。

### 执行者反馈或请求帮助
- **Git 推送权限问题**：由于权限拒绝 (403)，无法将代码推送到 GitHub。这通常是因为本地 Git 配置了错误的全局用户凭证，或者缺少对目标仓库的写入权限。建议用户在终端中手动处理凭证，或检查是否有正确的 Access Token。
**样式一致性**：已根据 `PodUI copy.html` 将 Toolbar 样式调整为深色 Navy 玻璃风格，解决了之前颜色不对的问题。

### 清理旧版本（标签）计划（2025-11-13 阈值）

目标：删除 2025-11-13 之前的 Git 版本（以“版本”理解为发布标签），保留 2025-11-13 及之后的标签（如 `qd0.1.0`），不改写提交历史，避免使用 `--force`。

范围与约束：
- 范围：仅清理 Git 标签（tags），同时修改分支提交历史。
- 约束：不进行强制推送；如需改写历史将先征求用户同意。

实施步骤：
- 列出所有标签，并为每个标签获取对应提交的时间（`git log -1 --format=%cI <tag>`）。
- 选出在 2025-11-13 之前的标签集合。
- 在本地删除这些旧标签（`git tag -d <tag>`）。
- 推送到远程删除对应标签（`git push origin :refs/tags/<tag>`）。

成功标准：
- 远程仓库的标签列表不再包含 2025-11-13 之前的旧标签。
- 近期标签（如 `qd0.1.0`）保留且可用。
- 未进行任何强制推送（符合既定安全规则）。

执行记录占位：
- 待执行并填写：删除的标签数量与示例名称，远程删除结果摘要。

```
### 提交历史重写计划（删除提交历史）

目标：将仓库提交历史重置为自 2025-11-13 后的单一初始提交（保留当前工作树），并保留必要标签（如 `qd0.1.0`）重新指向新提交。

风险与约束：
- 该操作需要强制推送（`--force-with-lease`），执行前需用户确认。

实施步骤：
- 创建孤立分支：`git checkout --orphan main-clean`
- 暂存并提交当前工作树：`git add -A && git commit -m "chore: reset history (2025-12-07)"`
- 重标记近期标签：`git tag -f qd0.1.0`
- 用新分支替换 `main`：`git branch -M main`
- 不推送，等待批准：准备 `git push --force-with-lease origin main`

成功标准：
- 本地 `git log` 显示单一初始提交。
- 标签 `qd0.1.0` 指向新提交。

执行记录占位：
- 待执行并填写：新初始提交的 SHA；重标记的标签列表。
